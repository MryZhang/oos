<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html lang="de"> 
  <head> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/> 
    <title>Open Object Store</title> 
  	<link rel="stylesheet" type="text/css" href="style.css" />
  </head> 
  <body>
    <div id="header">
      <a href="https://github.com/zussel/oos"><img style="z-order: 10000; float: left; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_green_007200.png" alt="Fork me on GitHub"></a>
      <div id="navigation">
        <h1>OOS</h1>
        <p>Store all your objects in one container</p>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li class="selected">Documention</li>
          <li><a href="../download.html">Download</a></li>
          <li><a href="../contact.html">Contact</a></li>
          <li><a href="../about.html">About</a></li>
        </ul>
      </div>
    </div>
    <div id="wrapper">
      <!--div id="header">
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li class="selected">Documention</li>
          <li><a href="../download.html">Download</a></li>
          <li><a href="../tutorial.html">Tutorial</a></li>
          <li><a href="../about.html">About</a></li>
        </ul>
        <div id="logo">
          <table cellspacing="0">
            <tr>
              <td class="oos">OOS</td>
              <td class="tagline">Store all your objects in one container.</td>
            </tr>
          </table>
        </div>
      </div-->
      <div id="content">
        <div>
<!-- Generated by Doxygen 1.8.3 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Documentation</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">The ObjectStore </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> 
<div class="width75 float_left">
 
<table id="doc_nav"><tbody><tr>
  <td align="left" width="40%">
 <a class="el" href="index.html">Introduction</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="relations.html">Object Relations</a>  
  </td>
</tr></tbody></table>
<h1><a class="anchor" id="objects_sec"></a>
Objects</h1>
<p>As mentioned above there are three rules you have to follow while intergrating your object classes into OOS.</p>
<h2><a class="anchor" id="step1"></a>
Step 1: Derive your class from oos::object.</h2>
<p>All your entity classes or extity base classes must be derived from <a class="el" href="classoos_1_1object.html" title="The base class for all objects.">oos::object</a> and must have a default constructor.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>person : <span class="keyword">public</span> <a class="code" href="classoos_1_1object.html" title="The base class for all objects.">oos::object</a></div>
<div class="line">{</div>
<div class="line">  std::string name_;</div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  person();</div>
<div class="line">  <span class="keyword">virtual</span> ~person();</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="step2"></a>
Step 2: Provide propper acces methods.</h2>
<p>Write correct access (get/set) methods for all your member attributes. It is important when modifying an attribute to use the <a class="el" href="classoos_1_1object.html#a074a2d4129a34648d3cc124c05782370">oos::object::modify()</a> method. It tells the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> and the <a class="el" href="classoos_1_1object__observer.html" title="Base class for object observer classes.">oos::object_observer</a> objects that an object is modified.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> person::name(<span class="keyword">const</span> std::string &amp;n)</div>
<div class="line">{</div>
<div class="line">  modify(name_, n);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">std::string name()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">return</span> name_;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="step3"></a>
Step 3: Make the class serializable.</h2>
<p>To make the class serializable you have to implement the methods <a class="el" href="classoos_1_1object.html#a4be241c502b8a122408fe5f0f6c23879">oos::object::serialize()</a> and <a class="el" href="classoos_1_1object.html#aaaba060509fd8614504a20d94aed2277">oos::object::deserialize()</a>. And don't forget to call these methods for your super class.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> person::serialize(<a class="code" href="classoos_1_1object__reader.html" title="Base class for all object reader.">oos::object_reader</a> &amp;serializer)</div>
<div class="line">{</div>
<div class="line">  object::serialize(serializer);</div>
<div class="line">  serializer.<a class="code" href="classoos_1_1object__reader.html#a25c6e3a5fcddeb1420166f9849957b6b" title="Read a single character from the atomizer.">read</a>(<span class="stringliteral">&quot;name&quot;</span>, name_);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> person::deserialize(<a class="code" href="classoos_1_1object__writer.html" title="Base class for all object writer.">oos::object_writer</a> &amp;deserializer)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  object::deserialize(deserializer);</div>
<div class="line">  deserializer-&gt;<a class="code" href="classoos_1_1object__writer.html#a0f20c65aaea6184b95e7247eca3e3ef3" title="Write a single character to the atomizer.">write</a>(<span class="stringliteral">&quot;name&quot;</span>, name_);</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="object_store_sec"></a>
Object Store</h1>
<p>Now that you've written your entity classes you might want to insert them into the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a>. But before doing so you have to tell the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> about your entity hierarchy once.</p>
<h2><a class="anchor" id="prototypes"></a>
Setup object hierarchy</h2>
<p>Assume we have the abstract base class Vehicle and derived from this classes Truck, Car and Bike. Now lets make this hierarchy known to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a>:</p>
<div class="fragment"><div class="line"><a class="code" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> ostore;</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#adc959b6a1fdc043c3a22157e94a64c65">insert_prototype</a>&lt;Vehicle&gt;(<span class="stringliteral">&quot;vehicle&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#adc959b6a1fdc043c3a22157e94a64c65">insert_prototype</a>&lt;Truck, Vehicle&gt;(<span class="stringliteral">&quot;truck&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#adc959b6a1fdc043c3a22157e94a64c65">insert_prototype</a>&lt;Car, Vehicle&gt;(<span class="stringliteral">&quot;car&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#adc959b6a1fdc043c3a22157e94a64c65">insert_prototype</a>&lt;Bike, Vehicle&gt;(<span class="stringliteral">&quot;bike&quot;</span>);</div>
</div><!-- fragment --><p>As you can see it is quite simple to add the hierarchy to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> by calling method <a class="el" href="classoos_1_1object__store.html#adc959b6a1fdc043c3a22157e94a64c65">oos::object_store::insert_prototype</a>. As there are several ways to call this method we decide to use the one with template arguments.</p>
<p>The Vehicle class is an abstract base (directly derived from <a class="el" href="classoos_1_1object.html" title="The base class for all objects.">oos::object</a>). Here we need only one template argument (the class itself: Vehicle). With the first method paramter you give your type a unique name. The second parameter is a flag telling the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> that this type is abstract. Settings this flag to true you can't insert objects of this concrete type.</p>
<h2><a class="anchor" id="add_objects"></a>
Add objects</h2>
<p>Now that we've setup up our hierarchy we can add new objects to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a>.</p>
<div class="fragment"><div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Car(<span class="stringliteral">&quot;VW Beetle&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Bike(<span class="stringliteral">&quot;Honda&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="modify_objects"></a>
Modify objects</h2>
<p>Now that we have some objects inserted we may want to modify them. The important thing here is that you don't deal with raw pointer to your object when try to modify it. You always have a pointer object wrapped around the object (like shared_ptr). Here it is called <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr</a>. So how do you get such a <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr</a>? The <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects.">oos::object_store</a> for example returns an <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr</a> object when you insert a new object. Once you received the <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr</a> you can change your object by using it like usual pointer.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr&lt;Truck&gt;</a> truck_ptr;</div>
<div class="line">truck_ptr truck = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>));</div>
<div class="line"></div>
<div class="line">truck-&gt;weight(2.5);</div>
<div class="line">truck-&gt;color(<span class="stringliteral">&quot;red&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="remove_objects"></a>
Remove objects</h2>
<p>Once we have an object_ptr object we can easily delete this object from the object_store by calling <a class="el" href="classoos_1_1object__store.html#a2f270d04113962cf27df38dc15a0779a">oos::object_store::remove()</a></p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object.">oos::object_ptr&lt;Truck&gt;</a> truck_ptr;</div>
<div class="line">truck_ptr truck = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>));</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (ostore.<a class="code" href="classoos_1_1object__store.html#a2f270d04113962cf27df38dc15a0779a">remove</a>(truck)) {</div>
<div class="line">  <span class="comment">// successfully removed object</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// object removal failed</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>When removing an object internally a check is done if the object (and subsequently all connected objects) can be removed. This test is done by checking the pointer and reference count of each concerning object. If the test succeeds the object is removed and true is returned. If the test fails false is returned.</p>
 
<table id="doc_nav"><tbody><tr>
  <td align="left" width="40%">Prev</td>
  <td align="center" width="20%"></td>
  <td align="right" width="40%">Next</td></tr><tr>
  <td align="left" width="40%">
 <a class="el" href="index.html">Introduction</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="relations.html">Object Relations</a>  
  </td>
</tr></tbody></table>
 
</div>
<div id="side_toc" class="width25 float_right">
 <b>Table of content</b> <br/>
 </p>
<ul>
<li>
<a class="el" href="index.html">Introduction</a> <ul>
<li>
<a class="el" href="index.html#intro_sec">Overview</a></li>
</ul>
</li>
<li>
<a class="el" href="store.html">The ObjectStore</a> <ul>
<li>
<a class="el" href="store.html#objects_sec">Objects</a> </li>
<li>
<a class="el" href="store.html#object_store_sec">Object Store</a> <ul>
<li>
<a class="el" href="store.html#prototypes">Setup object hierarchy</a> </li>
<li>
<a class="el" href="store.html#add_objects">Add objects</a> </li>
<li>
<a class="el" href="store.html#modify_objects">Modify objects</a> </li>
<li>
<a class="el" href="store.html#remove_objects">Remove objects</a> </li>
</ul>
</li>
</ul>
</li>
<li>
<a class="el" href="relations.html">Object Relations</a> </li>
<li>
<a class="el" href="view.html">Object Views</a> <ul>
<li>
<a class="el" href="relations.html#one_to_one">OneToOne relations</a> </li>
<li>
<a class="el" href="relations.html#one_to_many">OneToMany relations</a> </li>
</ul>
</li>
<li>
<a class="el" href="expressions.html">Expressions</a> </li>
<li>
<a class="el" href="database.html">Persist Objects</a> </li>
</ul>
 
</div>
 </div></div><!-- contents -->
    <div class="clear" id="footer"></div>
  </div>
</body>
</html>
